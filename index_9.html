<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8" />
	    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
		<meta http-equiv="Page-Enter" content="revealTrans(Duration=2.0,Transition=12)" />
		<title>大屏数据可视化 - 模板</title>
		<link rel="stylesheet" href="css/app.css" />
		<link rel="stylesheet" href="css/mine.css" />
		<link rel="stylesheet" href="css/style.css" />

		<!-- JQuery -->
		<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		
		<!-- 弹出窗口 -->
		<link rel="stylesheet" href="css/hover_window_2.css" />
		<link rel="stylesheet" href="css/hover_window.css" />
		<script type="text/javascript" src="js/hover_window_2.js"></script>
		<script type="text/javascript" src="js/hover_window_2.js"></script>
		
		<!-- echarts -->
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
		<script type="text/javascript" src="js/color.js"></script>
		
		<!-- semantic UI -->
		<link href="https://cdn.bootcdn.net/ajax/libs/semantic-ui/2.4.1/components/icon.css" rel="stylesheet">
		<link href="https://cdn.bootcdn.net/ajax/libs/semantic-ui/2.4.1/components/button.css" rel="stylesheet">
		<link href="https://cdn.bootcdn.net/ajax/libs/semantic-ui/2.4.1/components/table.css" rel="stylesheet">

		<!-- <script src="json/data.json"></script> -->
		<script type="text/javascript" src="js/global_config.js"></script>
	</head>
	
	<body>
		<div class="header">
			<h1 class="header-title" style="font-size:40px">上海市质量状况可视化展图</h1>
		</div>
		
		<div class="wrapper">
			<div class="content">
				<div class="col col-l">
					<div class="xpanel-wrapper xpanel-wrapper-50">
						<div class="xpanel xpanel-l-t">
							<div class="title">2017年上海市出境不合格货值分布情况<!-- i class="edit exchange icon" onclick="change_option_2_1()""></i><i class="edit outline icon" onclick="popBoxSuffix('_1_1')"></i--></div>
							<div class="echart-container" id="container_9_1"></div>
						</div>
					</div>
					<div class="xpanel-wrapper xpanel-wrapper-55">
						<div class="xpanel xpanel-l-b">
							<div class="title">2008-2017年上海市空气环境质量状况统计<!-- a href="./index_2.html">质量大数据平台</a--></div>
							<div class="echart-container" id="container_9_2"></div>
						</div>
					</div>
				</div>
				<div class="col col-c">
					<div class="xpanel-wrapper xpanel-wrapper-50">
						<div class="xpanel xpanel-c-t">
							<div class="title">2017年上海市入境不合格货值分布情况</div>
							<div class="echart-container" id="container_9_3"></div>
						</div>
					</div>
					<div class="xpanel-wrapper xpanel-wrapper-55">
						<div class="xpanel xpanel-c-b">
							<div class="title">2014-2017年上海市地表水环境质量状况统计</div>
							<div class="echart-container" id="container_9_4"></div>
						</div>
					</div>
				</div>
				<div class="col col-r">
					<div class="xpanel-wrapper xpanel-wrapper-50">
						<div class="xpanel xpanel-r-t">
							<div class="title">2017年上海市入境不合格原因分布情况<!--i class="edit exchange icon" onclick="change_option_2_5()""></i--></div>
							<div class="echart-container" id="container_9_5"></div>
						</div>
					</div>
					<div class="xpanel-wrapper xpanel-wrapper-55">
						<div class="xpanel xpanel-r-b">
							<div class="title">2008-2017年上海市噪声情况统计</div>
							<div class="echart-container" id="container_9_6"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<svg onclick="location='./index_2.html'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 32 32" id="previous" version="1.1" viewBox="0 0 32 32" xml:space="preserve">
			<path d="M7.701,14.276l9.586-9.585c0.879-0.878,2.317-0.878,3.195,0l0.801,0.8c0.878,0.877,0.878,2.316,0,3.194  L13.968,16l7.315,7.315c0.878,0.878,0.878,2.317,0,3.194l-0.801,0.8c-0.878,0.879-2.316,0.879-3.195,0l-9.586-9.587  C7.229,17.252,7.02,16.62,7.054,16C7.02,15.38,7.229,14.748,7.701,14.276z" fill="#FFFFFF"/>
		</svg>

		<div id="popLayer"></div>
		<div id="popBox_1_1" class="popBox">
			<!-- <div class="close">
				<a href="javascript:void(0)" onclick="closeBoxSuffix('_1_1')">关闭</a>
			</div> -->
			<div class="content" style="overflow: scroll; max-height: 80%;">
				<table id="table_1_1" class="ui definition table">
					<thead>
						<tr><th></th>
						<th>Arguments</th>
					</tr></thead>
					<tbody>
						<tr>
						<td>reset rating</td>
						<td>
							<div class="ui input">
								<input type="text" placeholder="搜索...">
						  	</div>
						</td>
						</tr>
						<tr>
						<td>set rating</td>
						<td>
							<div class="ui input">
								<input type="text" placeholder="搜索...">
						  	</div>
						</td>
						</tr>
					</tbody>
				</table>
			</div>

			<div class="dlg_bottom">
				<button class="ui primary button" onclick="alert('submit success!')">
					保存
				</button>
				<button class="ui button" onclick="closeBoxSuffix('_1_1')">
					关闭
				</button>
				<button class="ui button" onclick="addTableRow('_1_1')">
					添加一行
				</button>
			</div>

		</div>
		<script>
			// initHoverWindowBySuffix('_1_1', submitHandler, function(){hideDialogID('_1_1')});
		</script>
	</body>
</html>

<script>
    var data_1 = {};

    function demo(res){
        data_1 = res;
		console.log(data_1);
    }
</script>
<script src="data/data2.json?callback=demo"></script>

<!--* 图 9_1 -->
<script>
    var ori_data_9_1 = {};

    function callback_3_9_1(res){
        ori_data_9_1 = res;
		console.log('3_9_1.json读取成功')
		console.log(ori_data_9_1);
    }
</script>
<script src="data/3_9_1.json?callback=callback_3_9_1"></script>

<script>

	var dom_9_1 = document.getElementById("container_9_1");
	var myChart_9_1 = echarts.init(dom_9_1, 'chalk');
	var app_9_1 = {};

	function view_9_1_1_change(){
		console.log("9_1_1 change")
		// Document.getElementById('view_2_1_1').innerHTML
		console.log(document.getElementById('view_9_1_1').value)
		document.getElementById('view_9_1_1').innerHTML = document.getElementById('view_9_1_1').value
	}

	// 柱状图
	var option_9_1_1 = {
		// title: {
		// 	text: '漏斗图',
		// 	subtext: '纯属虚构'
		// },
		tooltip: {
			trigger: 'item',
			formatter: "{a} <br/>{b} : {c}%"
		},
		toolbox: {
			itemSize: echart_toolbox_size, 
            orient: 'vertical',
			feature: {
				dataView: {
					readOnly: false,
					optionToContent: function(opt) {
						// console.log(opt)
						// var axisData = opt['xAxis'][0]['data'];
						var series = opt['series'];
						console.log("start show")
						// console.log(axisData)
						// console.log(series)
						var table = '<textarea id="view_9_1_1" onchange="view_9_1_1_change()" style="width: 100%; height: 100%; font-family: monospace; font-size: 14px; line-height: 1.6rem; color: rgb(0, 0, 0); border-color: rgb(51, 51, 51); background-color: rgb(255, 255, 255);">\n';
						table += option_9_1_1['series'][0]['name'];
						table += '\n';
						table += "类别,数值\n"
						// var table = '<div style=" overflow-y:auto;height: 100%;width:100%;"><table style="width:100%;text-align:center"><tbody><tr>'
						// 			+ '<td><font color="red">时间</font></td>'
						// 			+ '<td>' + '数值' + '</td>'
						// 			+ '</tr>';
						for (var i = 0, l = series[0].data.length; i < l; i++) {
							// table += '<tr>'
							// 		+ '<td>' + axisData[i] + '</td>'
							// 		+ '<td>' + series[0].data[i] + '</td>'
							// 		+ '</tr>';
							table += series[0].data[i].name+','+series[0].data[i].value+'\n'
						}
						table += '</textarea>'
						// table += '</tbody></table></div>';
						// console.log(table)
						return table;
						// return option_2_1_1['xAxis']['data']
					},
					contentToOption:function(HTMLDomElement, opt){
						console.log("start save 9_1")

						var plain_tex = HTMLDomElement.firstChild.innerHTML;
						var arr_tex = plain_tex.split('\n')

						X_9_1 = [];
						Y_9_1 = [];

						for(var i = 2; i < arr_tex.length; ++i){
							cur_pair = arr_tex[i].split(',');
							if(cur_pair.length != 2){
								// console.alert('wrong data')
								continue
							}
							if(cur_pair[0] == '' || cur_pair[0] == undefined){
								continue
							}
							X_9_1.push(cur_pair[0]);
							Y_9_1.push(cur_pair[1]);
						}

						option_9_1_1['legend']['data'] = X_9_1;

						option_9_1_1['series'][0]['data'] = [];

						for(var i = 0; i < X_9_1.length; ++i){
							option_9_1_1['series'][0]['data'].push({
								value: Y_9_1[i],
								name: X_9_1[i],
							})
						}
						
						myChart_9_1.setOption(option_9_1_1);

						var Link = document.createElement('a');
						Link.download = "3_9_1.json";
						Link.style.display = 'none';
						// 字符内容转变成blob地址
						var blob = new Blob(['callback_3_9_1('+JSON.stringify(option_9_1_1)+')']);
						Link.href = URL.createObjectURL(blob);
						// 触发点击 	
						document.body.appendChild(Link);
						Link.click();
						// 然后移除
						document.body.removeChild(Link);
						return opt
					},
				},
				restore: {},
				saveAsImage: {},
				
			}
		},
		legend: {
			data: ['化工品','食品化妆品','机电产品','其他'],
			textStyle: { //图例文字的样式
				color: color_legend,
				fontSize: fontSize_all_legend
			},
		},

		series: [
			{
				name:'上海市出境不合格货值分布情况',
				type:'funnel',
				left: '10%',
				top: 60,
				//x2: 80,
				bottom: 60,
				width: '80%',
				// height: {totalHeight} - y - y2,
				min: 0,
				max: 100,
				minSize: '0%',
				maxSize: '100%',
				sort: 'descending',
				gap: 2,
				label: {
					show: true,
					position: 'inside',
					textStyle: { //图例文字的样式
						color: color_axis,
						fontSize: fontSize_axis_label
					},
				},
				labelLine: {
					length: 10,
					lineStyle: {
						width: 1,
						type: 'solid'
					}
				},
				itemStyle: {
					borderColor: '#fff',
					borderWidth: 1
				},
				emphasis: {
					label: {
						fontSize: 20
					}
				},
				data: [
					{value: 93, name: '化工品'},
					{value: 5, name: '食品化妆品'},
					{value: 1, name: '机电产品'},
					{value: 1, name: '其他'},
				]
			}
		]
	};

	option_9_1_1['series'][0]['data'] = ori_data_9_1['series'][0]['data'];
	option_9_1_1['series'][0]['name'] = ori_data_9_1['series'][0]['name'];
	option_9_1_1['legend']['data'] = ori_data_9_1['legend']['data'];

	myChart_9_1.setOption(option_9_1_1, true);


</script>

<!--* 图 9_2 -->
<script>

	var dom_9_2 = document.getElementById("container_9_2");
	var myChart_9_2 = echarts.init(dom_9_2, 'chalk');
	var app_9_2 = {};

	var option_9_2_1 = {
		tooltip: {
			trigger: 'axis',
			axisPointer: {            // 坐标轴指示器，坐标轴触发有效
				type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
			}
		},
		toolbox: {
			show: true,
			itemSize: echart_toolbox_size, 
            orient: 'vertical',
			feature: {
				dataView: {show: true, readOnly: false},
				magicType: {show: true, type: ['line','bar']},
				// restore: {show: true},
				saveAsImage: {show: true}
			}
		},
		legend: {
			data: ['AQI优良天数', '颗粒物为首要污染物天数'],
			textStyle: { //图例文字的样式
				color: color_legend,
				fontSize: fontSize_all_legend
			},
		},
		grid: {
			left: '3%',
			right: '4%',
			bottom: '3%',
			containLabel: true
		},
		xAxis: [
			{
				type: 'category',
				data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
				axisLabel:{
					textStyle: { //图例文字的样式
						color: color_axis,
						fontSize: fontSize_axis_label
					},
				}
			}
		],
		yAxis: [
			{
				type: 'value',
				max: 365,
				axisLabel:{
					textStyle: { //图例文字的样式
						color: color_axis,
						fontSize: fontSize_axis_label
					},
				}
			}
		],
		series: [
			{
				name: 'AQI优良天数',
				type: 'bar',
				// stack: '抽查情况',
				data: [120, 132, 101, 134, 90, 230, 210]
			},
			{
				name: '颗粒物为首要污染物天数',
				type: 'bar',
				// stack: '抽查情况',
				data: [220, 182, 191, 234, 290, 330, 310]
			}
		]
	};


	console.log(data_1["2008-2017年上海市空气环境质量状况统计（缺2017年数"])
	var data_9_2 = data_1["2008-2017年上海市空气环境质量状况统计（缺2017年数"];

	var X_9_2 = [];
	// AQI优良天数
	var Y_9_2_1 = [];
	// 颗粒物为首要污染物天数
	var Y_9_2_2 = [];


	for(var i = 1; i < data_9_2.length; ++i){
		X_9_2.push(data_9_2[i][0]);
		Y_9_2_1.push(data_9_2[i][1]);
		Y_9_2_2.push(data_9_2[i][3]);
	}

	console.log(option_9_2_1)

	option_9_2_1['series'][0]['data'] = Y_9_2_1;
	option_9_2_1['series'][1]['data'] = Y_9_2_2;
	option_9_2_1['xAxis'][0]['data'] = X_9_2;
	// myChart_9_2.setOption(option_9_2_1);

	// option_9_2_2['dataset']['source'] = [
	// 	['product'].concat(X_9_2);
	// 	['不合格数'].concat(Y_9_2_2);
	// 	['合格数'].concat(Y_9_9_3);
	// ];
	// option_9_2_2['dataset']['source'].push(['product'].concat(X_9_2));
	myChart_9_2.setOption(option_9_2_1);

	// myChart_9_2.on('magictypechanged', function (params) {
	// 	let o = { ...params };
	// 	console.log(params)
	// 	if(params.currentType == 'line'){
	// 		// o.newOption = option_2_1_2;
	// 	}else if(params.currentType == 'bar'){
	// 		o.newOption = option_9_2_1;
	// 	}
	// 	myChart_9_2.setOption(o.newOption, true);
	// });

	// myChart_9_2.on('restore', function (params) {
	// 	let o = { ...params };
	// 	console.log(params)
	// 	o.newOption = option_9_2_2;
	// 	myChart_9_2.setOption(o.newOption, true);
	// });




</script>

<!--* 图 9_3 -->
<script>
    var ori_data_9_3 = {};

    function callback_3_9_3(res){
        ori_data_9_3 = res;
		console.log('3_9_3.json读取成功')
		console.log(ori_data_9_3);
    }
</script>
<script src="data/3_9_3.json?callback=callback_3_9_3"></script>

<script>

	var dom_9_3 = document.getElementById("container_9_3");
	var myChart_9_3 = echarts.init(dom_9_3, 'chalk');
	var app_9_3 = {};

	function view_9_3_1_change(){
		console.log("9_3_1 change")
		// Document.getElementById('view_2_1_1').innerHTML
		console.log(document.getElementById('view_9_3_1').value)
		document.getElementById('view_9_3_1').innerHTML = document.getElementById('view_9_3_1').value
	}

	// 柱状图
	var option_9_3_1 = {
		// title: {
		// 	text: '漏斗图',
		// 	subtext: '纯属虚构'
		// },
		tooltip: {
			trigger: 'item',
			formatter: "{a} <br/>{b} : {c}%"
		},
		toolbox: {
			itemSize: echart_toolbox_size, 
            orient: 'vertical',
			feature: {
				dataView: {
					readOnly: false,
					optionToContent: function(opt) {
						// console.log(opt)
						// var axisData = opt['xAxis'][0]['data'];
						var series = opt['series'];
						console.log("start show")
						// console.log(axisData)
						// console.log(series)
						var table = '<textarea id="view_9_3_1" onchange="view_9_3_1_change()" style="width: 100%; height: 100%; font-family: monospace; font-size: 14px; line-height: 1.6rem; color: rgb(0, 0, 0); border-color: rgb(51, 51, 51); background-color: rgb(255, 255, 255);">\n';
						table += option_9_3_1['series'][0]['name'];
						table += '\n';
						table += "类别,数值\n"
						// var table = '<div style=" overflow-y:auto;height: 100%;width:100%;"><table style="width:100%;text-align:center"><tbody><tr>'
						// 			+ '<td><font color="red">时间</font></td>'
						// 			+ '<td>' + '数值' + '</td>'
						// 			+ '</tr>';
						for (var i = 0, l = series[0].data.length; i < l; i++) {
							// table += '<tr>'
							// 		+ '<td>' + axisData[i] + '</td>'
							// 		+ '<td>' + series[0].data[i] + '</td>'
							// 		+ '</tr>';
							table += series[0].data[i].name+','+series[0].data[i].value+'\n'
						}
						table += '</textarea>'
						// table += '</tbody></table></div>';
						// console.log(table)
						return table;
						// return option_2_1_1['xAxis']['data']
					},
					contentToOption:function(HTMLDomElement, opt){
						console.log("start save 9_3")

						var plain_tex = HTMLDomElement.firstChild.innerHTML;
						var arr_tex = plain_tex.split('\n')

						X_9_3 = [];
						Y_9_3 = [];

						for(var i = 2; i < arr_tex.length; ++i){
							cur_pair = arr_tex[i].split(',');
							if(cur_pair.length != 2){
								// console.alert('wrong data')
								continue
							}
							if(cur_pair[0] == '' || cur_pair[0] == undefined){
								continue
							}
							X_9_3.push(cur_pair[0]);
							Y_9_3.push(cur_pair[1]);
						}

						option_9_3_1['legend']['data'] = X_9_3;

						option_9_3_1['series'][0]['data'] = [];

						for(var i = 0; i < X_9_3.length; ++i){
							option_9_3_1['series'][0]['data'].push({
								value: Y_9_3[i],
								name: X_9_3[i],
							})
						}
						
						myChart_9_3.setOption(option_9_3_1);

						var Link = document.createElement('a');
						Link.download = "3_9_3.json";
						Link.style.display = 'none';
						// 字符内容转变成blob地址
						var blob = new Blob(['callback_3_9_3('+JSON.stringify(option_9_3_1)+')']);
						Link.href = URL.createObjectURL(blob);
						// 触发点击 	
						document.body.appendChild(Link);
						Link.click();
						// 然后移除
						document.body.removeChild(Link);
						return opt
					},
				},
				restore: {},
				saveAsImage: {},
				
			}
		},
		legend: {
			data: ['化工品','食品化妆品','机电产品','其他'],
			textStyle: { //图例文字的样式
				color: color_legend,
				fontSize: fontSize_all_legend
			},
		},

		series: [
			{
				name:'上海市出境不合格货值分布情况',
				type:'funnel',
				left: '10%',
				top: 60,
				//x2: 80,
				bottom: 60,
				width: '80%',
				// height: {totalHeight} - y - y2,
				min: 0,
				max: 100,
				minSize: '0%',
				maxSize: '100%',
				sort: 'descending',
				gap: 2,
				label: {
					show: true,
					position: 'inside',
					textStyle: { //图例文字的样式
						color: color_axis,
						fontSize: fontSize_axis_label
					},
				},
				labelLine: {
					length: 10,
					lineStyle: {
						width: 1,
						type: 'solid'
					}
				},
				itemStyle: {
					borderColor: '#fff',
					borderWidth: 1
				},
				emphasis: {
					label: {
						fontSize: 20
					}
				},
				data: [
					{value: 93, name: '化工品'},
					{value: 5, name: '食品化妆品'},
					{value: 1, name: '机电产品'},
					{value: 1, name: '其他'},
				]
			}
		]
	};

	option_9_3_1['series'][0]['data'] = ori_data_9_3['series'][0]['data'];
	option_9_3_1['legend']['data'] = ori_data_9_3['legend']['data'];
	option_9_3_1['series'][0]['name'] = ori_data_9_3['series'][0]['name'];

	myChart_9_3.setOption(option_9_3_1, true);


</script>

<!--* 图 9_4 -->
<script>

	var dom_9_4 = document.getElementById("container_9_4");
	var myChart_9_4 = echarts.init(dom_9_4, 'chalk');
	var app_9_4 = {};

	var option_9_4_1 = {
		toolbox: {
			show: true,
			itemSize: echart_toolbox_size, 
            orient: 'vertical',
			feature: {
				dataView: {show: true, readOnly: false},
				magicType: {show: true, type: ['line','bar','stack','tiled']},
				// restore: {show: true},
				saveAsImage: {show: true},
				myTool2: {
					show: true,
					title: '切换到饼图',
					icon: 'image://img/shuju-data.png',
					onclick: function (){
						myChart_9_4.setOption(option_9_4_2, true);
						curIsPie_9_4 = true;
					}
				}
			}
		},
		tooltip: {
			trigger: 'axis',
			axisPointer: {            // 坐标轴指示器，坐标轴触发有效
				type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
			}
		},
		legend: {
			data: [
				"Ⅱ～Ⅲ类水质断面占比",
				"Ⅳ～Ⅴ类断面占比",
				"劣Ⅴ类断面占比"
			],
			textStyle: { //图例文字的样式
				color: color_legend,
				fontSize: fontSize_all_legend
			},
		},
		grid: {
			left: '3%',
			right: '4%',
			bottom: '3%',
			containLabel: true
		},
		xAxis: [
			{
				type: 'category',
				data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
				axisLabel:{
					textStyle: { //图例文字的样式
						color: color_axis,
						fontSize: fontSize_axis_label
					},
				}
			}
		],
		yAxis: [
			{
				type: 'value',
				axisLabel:{
					textStyle: { //图例文字的样式
						color: color_axis,
						fontSize: fontSize_axis_label
					},
					formatter: function(value){
						return (value*1).toFixed(0)+'%'
					}
				}
			}
		],
		series: [
			{
				name: 'Ⅱ～Ⅲ类水质断面占比',
				type: 'bar',
				stack: '抽查情况',
				data: [120, 132, 101, 134, 90, 230, 210]
			},
			{
				name: 'Ⅳ～Ⅴ类断面占比',
				type: 'bar',
				stack: '抽查情况',
				data: [220, 182, 191, 234, 290, 330, 310]
			}
			,
			{
				name: '劣Ⅴ类断面占比',
				type: 'bar',
				stack: '抽查情况',
				data: [220, 182, 191, 234, 290, 330, 310]
			}
		]
	};

	var option_9_4_2 = {
		toolbox: {
			show: true,
			itemSize: echart_toolbox_size, 
            orient: 'vertical',
			feature: {
				dataView: {show: true, readOnly: false},
				// magicType: {show: true, type: ['bar']},
				// restore: {show: true},
				saveAsImage: {show: true},
				myTool2: {
					show: true,
					title: '切换到柱状图',
					icon: 'image://img/shuju-bar.png',
					onclick: function (){
						myChart_9_4.setOption(option_9_4_1, true);
						curIsPie_9_4 = false;
					}
				}
			}
		},
		legend: {
			data: [
				"Ⅱ～Ⅲ类水质断面占比",
				"Ⅳ～Ⅴ类断面占比",
				"劣Ⅴ类断面占比"
			],
			textStyle: { //图例文字的样式
				color: color_legend,
				fontSize: fontSize_all_legend
			},
		},
		tooltip: {},
		dataset: {
			source: [
				['product', '2014', '2015', '2016', '2017'],
				['Ⅱ～Ⅲ类水质断面占比', 24.7, 14.7, 16.2, 23.2],
				['Ⅳ～Ⅴ类断面占比', 26, 28.9, 49.8, 58.7],
				['劣Ⅴ类断面占比', 49.3, 56.4, 34, 18.1],
			]
		},
		series: [{
			type: 'pie',
			radius: '40%',
			// radius: 60,
			name: '2014',
			center: ['25%', '30%'],
			label: {
				formatter: '{d}%',
				color:color_axis
			},
			encode: {
				itemName: 'product',
				value: '2014'
			},
			roseType: "radius"
			// No encode specified, by default, it is '2012'.
		}, {
			type: 'pie',
			radius: '40%',
			// radius: 60,
			name: '2015',
			center: ['75%', '30%'],
			label: {
				formatter: '{d}%',
				color:color_axis
			},
			encode: {
				itemName: 'product',
				value: '2015'
			},
			roseType: "radius"
		},{
			type: 'pie',
			radius: '40%',
			// radius: 60,
			name: '2016',
			center: ['25%', '75%'],
			label: {
				formatter: '{d}%',
				color:color_axis
			},
			encode: {
				itemName: 'product',
				value: '2016'
			},
			roseType: "radius"
			// No encode specified, by default, it is '2012'.
		}, {
			type: 'pie',
			radius: '40%',
			name: '2017',
			center: ['75%', '75%'],
			label: {
				formatter: '{d}%',
				color:color_axis
			},
			encode: {
				itemName: 'product',
				value: '2017'
			},
			roseType: "radius"
			// No encode specified, by default, it is '2012'.
		},]
	};

	console.log(data_1["2014-2017年上海市地表水环境质量状况统计"])
	var data_9_4 = data_1["2014-2017年上海市地表水环境质量状况统计"];

	var X_9_4 = [];
	// Ⅱ～Ⅲ类水质断面占比
	var Y_9_4_1 = [];
	// 不Ⅳ～Ⅴ类断面占比
	var Y_9_4_2 = [];
	// 劣Ⅴ类断面占比
	var Y_9_4_3 = [];


	for(var i = 1; i < data_9_4.length; ++i){
		X_9_4.push(data_9_4[i][0]);
		Y_9_4_1.push(data_9_4[i][1]);
		Y_9_4_2.push(data_9_4[i][2]);
		Y_9_4_3.push(data_9_4[i][3]);
	}

	console.log(option_9_4_1)

	option_9_4_1['series'][0]['data'] = Y_9_4_1;
	option_9_4_1['series'][1]['data'] = Y_9_4_2;
	option_9_4_1['series'][2]['data'] = Y_9_4_3;
	option_9_4_1['xAxis'][0]['data'] = X_9_4;

	// option_9_4_2['dataset']['source'][0] = ['product'].concat(X_9_4);
	// option_9_4_2['dataset']['source'][1] = ['Ⅱ～Ⅲ类水质断面占比'].concat(Y_9_4_1);
	// option_9_4_2['dataset']['source'][2] = ['Ⅳ～Ⅴ类断面占比'].concat(Y_9_4_2);
	// option_9_4_2['dataset']['source'][3] = ['劣Ⅴ类断面占比'].concat(Y_9_4_3);

	console.log('9_4_2')
	console.log(option_9_4_2)


	myChart_9_4.setOption(option_9_4_1);

	// myChart_9_4.on('magictypechanged', function (params) {
	// 	let o = { ...params };
	// 	console.log(params)
	// 	if(params.currentType == 'line'){
	// 		// o.newOption = option_2_1_2;
	// 	}else if(params.currentType == 'bar'){
	// 		o.newOption = option_9_4_1;
	// 	}
	// 	myChart_9_4.setOption(o.newOption, true);
	// });

	var curIsPie_9_4 = false;

	// myChart_9_4.on('restore', function (params) {
	// 	let o = { ...params };
	// 	console.log(params)
	// 	if (curIsPie_9_4){
	// 		o.newOption = option_9_4_1;
	// 		myChart_9_4.setOption(o.newOption, true);	
	// 		curIsPie_9_4 = false;
	// 	}else{
	// 		o.newOption = option_9_4_2;
	// 		myChart_9_4.setOption(o.newOption, true);
	// 		curIsPie_9_4 = true;
	// 	}
	// });



</script>

<!--* 图 9_5 -->
<script>
    var ori_data_9_5 = {};

    function callback_3_9_5(res){
        ori_data_9_5 = res;
		console.log('3_9_5.json读取成功')
		console.log(ori_data_9_5);
    }
</script>
<script src="data/3_9_5.json?callback=callback_3_9_5"></script>

<script>

	var dom_9_5 = document.getElementById("container_9_5");
	var myChart_9_5 = echarts.init(dom_9_5, 'chalk');
	var app_9_5 = {};

	function view_9_5_1_change(){
		console.log("9_5_1 change")
		// Document.getElementById('view_2_1_1').innerHTML
		console.log(document.getElementById('view_9_5_1').value)
		document.getElementById('view_9_5_1').innerHTML = document.getElementById('view_9_5_1').value
	}

	// 柱状图
	var option_9_5_1 = {
		// title: {
		// 	text: '漏斗图',
		// 	subtext: '纯属虚构'
		// },
		tooltip: {
			trigger: 'item',
			formatter: "{a} <br/>{b} : {c}%"
		},
		toolbox: {
			itemSize: echart_toolbox_size, 
            orient: 'vertical',
			feature: {
				dataView: {
					readOnly: false,
					optionToContent: function(opt) {
						// console.log(opt)
						// var axisData = opt['xAxis'][0]['data'];
						var series = opt['series'];
						console.log("start show")
						// console.log(axisData)
						// console.log(series)
						var table = '<textarea id="view_9_5_1" onchange="view_9_5_1_change()" style="width: 100%; height: 100%; font-family: monospace; font-size: 14px; line-height: 1.6rem; color: rgb(0, 0, 0); border-color: rgb(51, 51, 51); background-color: rgb(255, 255, 255);">\n';
						table += "2017年上海市入境不合格货值分布情况\n";
						table += series[0]['name'];
						table += '\n';
						table += "类别,数值\n"
						// var table = '<div style=" overflow-y:auto;height: 100%;width:100%;"><table style="width:100%;text-align:center"><tbody><tr>'
						// 			+ '<td><font color="red">时间</font></td>'
						// 			+ '<td>' + '数值' + '</td>'
						// 			+ '</tr>';
						for (var i = 0, l = series[0].data.length; i < l; i++) {
							// table += '<tr>'
							// 		+ '<td>' + axisData[i] + '</td>'
							// 		+ '<td>' + series[0].data[i] + '</td>'
							// 		+ '</tr>';
							table += series[0].data[i].name+','+series[0].data[i].value+'\n'
						}
						table += '</textarea>'
						// table += '</tbody></table></div>';
						// console.log(table)
						return table;
						// return option_2_1_1['xAxis']['data']
					},
					contentToOption:function(HTMLDomElement, opt){
						console.log("start save 9_5")

						var plain_tex = HTMLDomElement.firstChild.innerHTML;
						var arr_tex = plain_tex.split('\n')

						X_9_5 = [];
						Y_9_5 = [];

						for(var i = 2; i < arr_tex.length; ++i){
							cur_pair = arr_tex[i].split(',');
							if(cur_pair.length != 2){
								// console.alert('wrong data')
								continue
							}
							if(cur_pair[0] == '' || cur_pair[0] == undefined){
								continue
							}
							X_9_5.push(cur_pair[0]);
							Y_9_5.push(cur_pair[1]);
						}

						option_9_5_1['legend']['data'] = X_9_5;

						option_9_5_1['series'][0]['data'] = [];

						for(var i = 0; i < X_9_5.length; ++i){
							option_9_5_1['series'][0]['data'].push({
								value: Y_9_5[i],
								name: X_9_5[i],
							})
						}
						
						myChart_9_5.setOption(option_9_5_1);

						var Link = document.createElement('a');
						Link.download = "3_9_5.json";
						Link.style.display = 'none';
						// 字符内容转变成blob地址
						var blob = new Blob(['callback_3_9_5('+JSON.stringify(option_9_5_1)+')']);
						Link.href = URL.createObjectURL(blob);
						// 触发点击 	
						document.body.appendChild(Link);
						Link.click();
						// 然后移除
						document.body.removeChild(Link);
						return opt
					},
				},
				restore: {},
				saveAsImage: {},
				
			}
		},
		legend: {
			data: ['化工品','食品化妆品','机电产品','其他'],
			textStyle: { //图例文字的样式
				color: color_legend,
				fontSize: fontSize_all_legend
			},
		},

		series: [
			{
				name:'上海市出境不合格货值分布情况',
				type:'funnel',
				left: '10%',
				top: 60,
				//x2: 80,
				bottom: 60,
				width: '80%',
				// height: {totalHeight} - y - y2,
				min: 0,
				max: 100,
				minSize: '0%',
				maxSize: '100%',
				sort: 'descending',
				gap: 2,
				label: {
					show: true,
					position: 'inside',
					textStyle: { //图例文字的样式
						color: color_axis,
						fontSize: fontSize_axis_label
					},
				},
				labelLine: {
					length: 10,
					lineStyle: {
						width: 1,
						type: 'solid'
					}
				},
				itemStyle: {
					borderColor: '#fff',
					borderWidth: 1
				},
				emphasis: {
					label: {
						fontSize: 20
					}
				},
				data: [
					{value: 93, name: '化工品'},
					{value: 5, name: '食品化妆品'},
					{value: 1, name: '机电产品'},
					{value: 1, name: '其他'},
				]
			}
		]
	};

	option_9_5_1['series'][0]['data'] = ori_data_9_5['series'][0]['data'];
	option_9_5_1['series'][0]['name'] = ori_data_9_5['series'][0]['name'];
	option_9_5_1['legend']['data'] = ori_data_9_5['legend']['data'];

	myChart_9_5.setOption(option_9_5_1, true);


</script>

<!--* 图 9_6 -->
<script>

	var dom_9_6 = document.getElementById("container_9_6");
	var myChart_9_6 = echarts.init(dom_9_6, 'chalk');
	var app_9_6 = {};

	var option_9_6_1 = {
		tooltip: {
			trigger: 'axis',
			axisPointer: {            // 坐标轴指示器，坐标轴触发有效
				type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
			}
		},
		toolbox: {
			show: true,
			itemSize: echart_toolbox_size, 
            orient: 'vertical',
			feature: {
				dataView: {show: true, readOnly: false},
				magicType: {show: true, type: ['line','bar']},
				// restore: {show: true},
				saveAsImage: {show: true}
			}
		},
		legend: {
			data: ['区域环境-昼间', '区域环境-夜间', '道路交通-昼间', '道路交通-夜间'],
			textStyle: { //图例文字的样式
				color: color_legend,
				fontSize: fontSize_all_legend
			},
		},
		grid: {
			left: '3%',
			right: '4%',
			bottom: '3%',
			containLabel: true
		},
		xAxis: [
			{
				type: 'category',
				data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
				axisLabel:{
					textStyle: { //图例文字的样式
						color: color_axis,
						fontSize: fontSize_axis_label
					},
				}
			}
		],
		yAxis: [
			{
				type: 'value',
				axisLabel:{
					textStyle: { //图例文字的样式
						color: color_axis,
						fontSize: fontSize_axis_label
					},
				}
				// max: 365,
			}
		],
		series: [
			{
				name: '区域环境-昼间',
				type: 'bar',
				// stack: '抽查情况',
				data: [120, 132, 101, 134, 90, 230, 210]
			},
			{
				name: '区域环境-夜间',
				type: 'bar',
				// stack: '抽查情况',
				data: [220, 182, 191, 234, 290, 330, 310]
			},
			{
				name: '道路交通-昼间',
				type: 'bar',
				// stack: '抽查情况',
				data: [120, 132, 101, 134, 90, 230, 210]
			},
			{
				name: '道路交通-夜间',
				type: 'bar',
				// stack: '抽查情况',
				data: [220, 182, 191, 234, 290, 330, 310]
			}
		]
	};


	console.log(data_1[" 2008-2017年上海市噪声情况统计（缺2017年数据）"])
	var data_9_6 = data_1[" 2008-2017年上海市噪声情况统计（缺2017年数据）"];

	var X_9_6 = [];
	// AQI优良天数
	var Y_9_6_1 = [];
	// 颗粒物为首要污染物天数
	var Y_9_6_2 = [];
	var Y_9_6_3 = [];
	var Y_9_6_4 = [];


	for(var i = 1; i < data_9_6.length; ++i){
		X_9_6.push(data_9_6[i][0]);
		Y_9_6_1.push(data_9_6[i][1]);
		Y_9_6_2.push(data_9_6[i][2]);
		Y_9_6_3.push(data_9_6[i][3]);
		Y_9_6_4.push(data_9_6[i][4]);
	}

	console.log(option_9_6_1)

	option_9_6_1['series'][0]['data'] = Y_9_6_1;
	option_9_6_1['series'][1]['data'] = Y_9_6_2;
	option_9_6_1['series'][2]['data'] = Y_9_6_3;
	option_9_6_1['series'][3]['data'] = Y_9_6_4;
	option_9_6_1['xAxis'][0]['data'] = X_9_6;

	myChart_9_6.setOption(option_9_6_1);

	// myChart_9_6.on('magictypechanged', function (params) {
	// 	let o = { ...params };
	// 	console.log(params)
	// 	if(params.currentType == 'line'){
	// 		// o.newOption = option_2_1_2;
	// 	}else if(params.currentType == 'bar'){
	// 		o.newOption = option_9_6_1;
	// 	}
	// 	myChart_9_6.setOption(o.newOption, true);
	// });

	// myChart_9_6.on('restore', function (params) {
	// 	let o = { ...params };
	// 	console.log(params)
	// 	o.newOption = option_9_6_2;
	// 	myChart_9_6.setOption(o.newOption, true);
	// });

</script>

<script>
	// window.addEventListener("resize", () => { 
	// 	this.myChart_2_1.resize();  
	// 	this.myChart_9_2.resize();  
	// 	this.myChart_9_3.resize();  
	// 	this.myChart_9_4.resize();  
	// 	this.myChart_2_5.resize();  
	// 	this.myChart_9_6.resize();  
	// });
</script>

<script>
	// $('<i id="back-to-top" onclick="history.back()"></i>').appendTo($('body'));
	$('<i id="back-to-top" onclick="location=\'./index_1.html\'"></i>').appendTo($('body'));
	$('#back-to-top').fadeIn();	

	$("#previous").show();

</script>